<div class="flex flex-col gap-10 shadow-lg px-10 py-10 bg-white rounded-lg h-full">
  <div class="flex flex-col gap-10">
    <h2 class="text-gray-800 font-bold text-3xl">Histórico</h2>
  </div>

    <div class=" overflow-x-auto max-h-132 overflow-y-auto">
    <table class="w-full table-fixed">
      <thead class=" border-b border-gray-200">
        <tr>
          <th class="px-4 py-2 text-left text-sm text-gray-700 font-semibold rounded-l-lg w-2/6">
            <span class="bg-white border-1 border-gray-300 text-gray-700 text-xs font-medium pl-2 pr-1 py-0.3 rounded-full mr-1">
              {{this.solicitacoes.length}}
            </span>
            ID
          </th>
          <th class="px-4 py-2 text-left text-sm text-gray-700 font-semibold w-2/6">Descrição do equipamento</th>
          <th class="px-4 py-2 text-left text-sm text-gray-700 font-semibold w-1/6">Data de abertura</th>
          <th class="px-4 py-2 text-left text-sm text-gray-700 font-semibold rounded-r-lg w-1/6"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        @for (solicitacao of solicitacoes; track solicitacao.id){
          <tr class="hover:bg-gray-50 transition-colors">
            <td class="px-12 py-2 text-sm text-gray-500">{{ solicitacao.id }}</td>
            <td class="px-4 py-2 text-sm text-gray-500">{{ solicitacao.equipamento }}</td>
            <td class="px-4 py-2 text-sm text-gray-500">{{ solicitacao.dataAbertura | date: 'dd/MM/yyyy' }}</td>
            <td class="px-12 py-2 space-x-4">
              <button type="button" class="px-1 py-1 rounded-full group hover:bg-gray-100 hover:cursor-pointer" (click)="abrirModalDetalhes(solicitacao)"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  height="24px"
                  width="24px"
                  viewBox="0 -960 960 960"
                  class="stroke-gray-500 fill-current text-gray-500 group-hover:stroke-gray-700 group-hover:text-gray-700 transition-colors"
                >
                  <path d="M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-134 0-244.5-72T61-462q-5-9-7.5-18.5T51-500q0-10 2.5-19.5T61-538q64-118 174.5-190T480-800q134 0 244.5 72T899-538q5 9 7.5 18.5T909-500q0 10-2.5 19.5T899-462q-64 118-174.5 190T480-200Zm0-300Zm0 220q113 0 207.5-59.5T832-500q-50-101-144.5-160.5T480-720q-113 0-207.5 59.5T128-500q50 101 144.5 160.5T480-280Z"/>
                </svg>
              </button>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="5" class="px-4 py-2 text-center text-gray-500">Nenhuma solicitação encontrada.</td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  @if(mostrarDetalhes){
    <div class="fixed inset-0 flex items-center justify-center bg-black/60 z-50">
      <div class="flex flex-col bg-white rounded-lg shadow-xl p-6 w-full max-w-lg">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-gray-800 font-bold text-2xl">Detalhes</h2>
          <button (click)="fecharModalDetalhes()" class="text-gray-500 hover:text-gray-700 hover:cursor-pointer">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
  
        <div class="flex flex-col gap-3">
          <div class="flex flex-col w-full border-1 border-gray-200 rounded-lg p-3 gap-3">
            <div class="flex justify-between">
              <div class="flex items-center gap-3">
                <h3 class="text-sm text-gray-600">Informações da solicitação </h3>
                <svg width="18" height="18" viewBox="0 0 40 40" fill="none" class="stroke-gray-600 " xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 13.3333V20M20 26.6667H20.0167M35 20C35 28.2843 28.2843 35 20 35C11.7157 35 5 28.2843 5 20C5 11.7157 11.7157 5 20 5C28.2843 5 35 11.7157 35 20Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>

              <div class="flex items-center gap-3">
                <span class="w-4 h-4 rounded-full flex items-center justify-center text-white text-xs font-bold" [style.background-color]="getStatusCor(solicitacao.status) "></span>
                <span class="text-gray-800 text-sm font-thin">{{ getStatusLabel(solicitacao.status) }}</span>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div class="flex flex-col">
                <span class="font-medium text-sm text-gray-700">ID</span> 
                <p class="text-gray-800 text-sm font-thin">#{{ solicitacao.id }}</p>
              </div>

              <div class="flex flex-col">
                <span class="font-medium text-sm text-gray-700">Equipamento</span> 
                <p class="text-gray-800 text-sm font-thin">{{ solicitacao.equipamento }}</p>
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div class="flex flex-col">
                <span class="font-medium text-sm text-gray-700">Data de Criação</span> 
                <p class="text-gray-800 text-sm font-thin">{{ getDataCriacao(solicitacao) | date:'dd/MM/yyyy HH:mm'  }}</p>
              </div>

              <div class="flex flex-col">
                <span class="font-medium text-sm text-gray-700">Data de finalização</span> 
                <p class="text-gray-800 text-sm font-thin">{{ getDataFinalizacao(solicitacao) | date:'dd/MM/yyyy HH:mm'  }}</p>
              </div>
            </div>
          </div>

          <div class="flex flex-col w-full border-1 border-gray-200 rounded-lg p-3 gap-3">
            <div class="flex items-center gap-3">
              <h3 class="text-sm text-gray-600">Informações da manutenção</h3>
              <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="24px" class="stroke-gray-600 "><path d="M354-386q-89.17 0-151.58-62.42Q140-510.83 140-600q0-11.33 1.5-22.67Q143-634 145-645q2-8 7-11.5t12-5.5q7-2 13.5 0t11.5 7l109 107 108-108-106-107q-5-5-7-12.19-2-7.19 0-14t6-11.81q4-5 11-7 11-3 22-4.5t22-1.5q89.17 0 151.58 62.42Q568-689.17 568-600q0 29-6 53t-18 45l242 242q19 18.73 19 45.87Q805-187 786.21-168q-18.79 19-46 19T694-168L452-410q-23 11-47.02 17.5Q380.95-386 354-386Zm0-28q26.67 0 53.33-7.5Q434-429 457-445l257 257q11 11 26 11t26-11q11-11 11-26t-11-26L509-497q15-22 23-48.5t8-54.5q0-77-62-139t-160-45l107 107q9 9 9 21t-9 21L319-529q-9 9-21 9t-21-9L170-636q-14 109 49 165.5T354-414Zm112-76Z"/></svg>
            </div>

            <div class="flex flex-col">
              <span class="font-medium text-sm text-gray-700">Responsável técnico</span> 
              <p class="text-gray-800 text-sm font-thin">{{ solicitacao.funcionario.nome }}</p>
            </div>

            <div class="flex flex-col">
              <span class="font-medium text-sm text-gray-700">Descrição</span> 
              <p class="text-gray-800 text-sm font-thin">{{ solicitacao.manutencao?.descricao }}</p>
            </div>

            <div class="flex flex-col">
              <span class="font-medium text-sm text-gray-700">Orientações</span> 
              <p class="text-gray-800 text-sm font-thin">{{ solicitacao.manutencao?.orientacao }}</p>
            </div>
          </div>

          <div class="flex flex-col w-full border-1 border-gray-200 rounded-lg p-3 gap-3">
            <div class="flex items-center gap-3">
              <h3 class="text-sm text-gray-600">Orçamento </h3>
              <svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 -960 960 960" width="18" class="stroke-gray-600"><path d="M459.38-215.38h39.24v-46.93q43.07-3.61 82.53-30.92 39.47-27.31 39.47-84.77 0-42-25.54-71.62-25.54-29.61-97.54-55.61-66.16-23.08-84.54-39.62-18.38-16.53-18.38-47.15 0-30.62 23.88-51t63.5-20.38q30.46 0 50.77 13.96 20.31 13.96 32.92 35.42l34.77-13.69q-14.08-28.85-41.27-48.31-27.19-19.46-58.57-21.69v-46.93h-39.24v46.93q-52.3 8.69-79.15 39-26.85 30.31-26.85 66.69 0 43.15 27.12 69.08Q409.62-497 474-473.69q64.54 23.77 86.73 42.92 22.19 19.15 22.19 52.77 0 42.23-30.8 60.81-30.81 18.57-66.12 18.57-34.54 0-62.35-20.11-27.8-20.12-44.42-57.27L344-360.77q17.08 41.08 45.81 64.04 28.73 22.96 69.57 32.42v48.93ZM480-120q-74.54 0-140.23-28.42-65.69-28.43-114.31-77.04-48.61-48.62-77.04-114.31Q120-405.46 120-480q0-74.54 28.42-140.23 28.43-65.69 77.04-114.31 48.62-48.61 114.31-77.04Q405.46-840 480-840q74.54 0 140.23 28.42 65.69 28.43 114.31 77.04 48.61 48.62 77.04 114.31Q840-554.54 840-480q0 74.54-28.42 140.23-28.43 65.69-77.04 114.31-48.62 48.61-114.31 77.04Q554.54-120 480-120Zm0-40q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
         
            </div>

            <div class="flex flex-col">
              <span class="font-medium text-sm text-gray-700">Preço total</span> 
              <p class="text-gray-800 text-sm font-thin">{{ solicitacao.orcamento?.valorTotal| currency:'BRL' }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>