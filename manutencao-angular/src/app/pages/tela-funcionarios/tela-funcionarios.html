<div class="flex flex-col items-center justify-start flex-grow p-6">
  <div class="flex min-w-2/3 place-content-between mb-5">
    <div>
      <input type="text" placeholder="Pesquisar" [(ngModel)]="pesquisa" class="w-100 rounded-md bg-white px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-300 sm:text-sm/6 border border-1 border-gray-300 outline-none focus:border-2 focus:border-gray-400" />
    </div>

    <button type="button" alt="Adicionar" class="py-2 px-3 rounded flex items-center justify-center group hover:bg-sky-500 hover:text-white" (click)="abrirAdicionar()">
      <svg width="22" height="22" viewBox="0 0 10 10" fill="none" class="stroke-sky-400 mr-2 group-hover:stroke-white" xmlns="http://www.w3.org/2000/svg">
        <path d="M4.99999 1.66667V8.33334M8.33332 5.00001L1.66666 5.00001" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>

      Adicionar
    </button>
  </div>

  <table class="min-w-2/3">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-2 text-left text-xs text-gray-700 font-semibold rounded-l-lg w-2/6">Nome</th>
        <th class="px-4 py-2 text-left text-xs text-gray-700 font-semibold w-2/6">E-mail</th>
        <th class="px-4 py-2 text-left text-xs text-gray-700 font-semibold w-1/6">Data de nascimento</th>
        <th class="px-4 py-2 text-left text-xs text-gray-700 font-semibold rounded-r-lg w-1/6">Ações</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      @for (funcionario of funcionariosFiltrados; track funcionario.idFuncionario){
        <tr class="hover:bg-gray-50 transition-colors">
          <td class="px-4 py-2 text-sm">{{ funcionario.nome }}</td>
          <td class="px-4 py-2 text-sm">{{ funcionario.usuario.email }}</td>
          <td class="px-4 py-2 text-sm">{{ funcionario.dataNascimento | date: 'dd/MM/yyyy' }}</td>
          <td class="px-4 py-2 space-x-2">
            <button type="button" class="px-2 py-1 bg-gray-100 text-white rounded group hover:bg-gray-300" (click)="abrirEditar(funcionario)">
              <svg width="22" height="22" viewBox="0 0 8 8" fill="none" class="stroke-gray-500 group-hover:stroke-gray-700" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_294_1596)">
                  <path d="M5.07736 1.74408L6.25587 2.92259M5.57736 1.24408C5.9028 0.918641 6.43044 0.918641 6.75587 1.24408C7.08131 1.56951 7.08131 2.09715 6.75587 2.42259L2.16664 7.01183H0.999969V5.82147L5.57736 1.24408Z" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"/>
                </g>
                <defs>
                  <clipPath id="clip0_294_1596">
                    <rect width="8" height="8" fill="white"/>
                  </clipPath>
                </defs>
              </svg>
            </button>

            <button type="button" class="px-2 py-1 bg-gray-100 text-white rounded group hover:bg-red-600" (click)="abrirExcluir(funcionario)">
              <svg width="22" height="22" viewBox="0 0 8 8" fill="none" class="stroke-[#C70003] group-hover:stroke-white" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.33334 2.33333L6.04424 6.38083C6.01932 6.7297 5.72902 7 5.37926 7H2.62076C2.271 7 1.9807 6.7297 1.95578 6.38083L1.66668 2.33333M3.33334 3.66667V5.66667M4.66668 3.66667V5.66667M5.00001 2.33333V1.33333C5.00001 1.14924 4.85077 1 4.66668 1H3.33334C3.14925 1 3.00001 1.14924 3.00001 1.33333V2.33333M1.33334 2.33333H6.66668"  stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </td>
        </tr>
      } @empty {
        <tr>
          <td colspan="4" class="px-4 py-2 text-center text-gray-500">Nenhum funcionário encontrado.</td>
        </tr>
      }
    </tbody>
  </table>

  @if (mostrarFormulario) {
    <div class="fixed inset-0 flex items-center justify-center bg-black/60 z-50">
      <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
        <form #formFuncionario="ngForm" (ngSubmit)="salvar()">
          <div>
            <h2 class="text-base/7 font-semibold text-gray-900">{{ modoFormulario === 'adicionar' ? 'Cadastrar funcionário' : 'Editar funcionário' }}</h2>
      
            <div class="col-span-6 mt-1.5">
              <input id="nome" placeholder="Nome" type="text" name="nome" [(ngModel)]="funcionario.nome" #nome="ngModel" required class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 sm:text-sm/6 border border-1 outline-none focus:border-2 focus:border-gray-400"
              />
            </div>
      
            <div class="col-span-6 mt-1.5">
              <input id="email" placeholder="E-mail" type="text" name="email" [(ngModel)]="funcionario.usuario.email" #email="ngModel" required class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 sm:text-sm/6 border border-1 outline-none focus:border-2 focus:border-gray-400"
              />
            </div>
      
            <div class="col-span-6 mt-1.5">
              <input id="senha" placeholder="Senha" type="text" name="senha" [(ngModel)]="funcionario.usuario.senha" #senha="ngModel" required class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 sm:text-sm/6 border border-1 outline-none focus:border-2 focus:border-gray-400"
              />
            </div>
      
            <div class="col-span-6 mt-1.5">
              <input id="data" placeholder="Data" type="date" name="data" [(ngModel)]="funcionario.dataNascimento" #data="ngModel" required class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 placeholder:text-gray-400 sm:text-sm/6 border border-1 outline-none focus:border-2 focus:border-gray-400"
              />
            </div>
          </div>
      
          <div class="mt-6 flex items-center justify-end gap-x-6">
            <button type="button" (click)="cancelar()" class="text-sm/6 font-semibold text-gray-900">Cancel</button>
            <button type="submit" [disabled]="formFuncionario.invalid" class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-xs hover:bg-indigo-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Salvar</button>
          </div>
        </form>
      </div>
    </div>
  }

  @if(mostrarPopupExclusao) {
    <div class="fixed inset-0 flex items-center justify-center bg-black/60 z-50">
      <div class="bg-red-600 rounded-lg shadow-xl w-full max-w-md">
        <div class="flex  p-6">
          <svg width="30" height="30" viewBox="0 0 40 40" fill="none" class="w-30 mt-3 stroke-white" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 13.3333V20M20 26.6667H20.0167M35 20C35 28.2843 28.2843 35 20 35C11.7157 35 5 28.2843 5 20C5 11.7157 11.7157 5 20 5C28.2843 5 35 11.7157 35 20Z" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>

          <div class="ml-2">
            <p class="text-lg font-bold text-white">Tem certeza de que deseja excluir este funcionário?</p>
            <p class="mt-3 text-md text-white">Esta ação é <span class="font-bold">permanente</span> e <span class="font-bold">não poderá ser desfeita</span>. Todas as informações do funcionário serão removidas do sistema.</p>

            <div class="mt-5">
              <button type="button" class="bg-white px-6 py-2 mr-10 rounded-md text-red-500 font-semibold hover:bg-red-200 hover:cursor-pointer hover:text-red-800" (click)="excluir()">Excluir</button>
              <button type="button" class="bg-red-700 px-6 py-2 mr-10 rounded-md text-white font-semibold hover:bg-red-800 hover:cursor-pointer" (click)="cancelar()">Cancelar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>